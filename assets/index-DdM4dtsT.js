import{t as w,q as p,r as f,j as r,G as a,J as h,B as P,E as b}from"./index-CfX38i0E.js";import{F as g}from"./FormModal-C1R4AyCJ.js";import{u as y}from"./index.esm-7bvCp7Uk.js";import{u as x}from"./useSubmitHandlers-Cwbi2rXh.js";import{h as S}from"./helperText-BjkVZXYi.js";import"./chunk-4FCEGNGT-B-jdCA2V.js";import"./chunk-7254PCTD-Dpa5zOsZ.js";import"./chunk-OFOVX77R-zSbCe2qK.js";import"./chunk-W7WUSNWJ-RwjSrdRn.js";async function F(s,e){return fetch("https://demo.boardly.nicolldouglas.dev/api/auth/reset",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s.getValues())})}function N(s,e){const{toast:o,...t}=w(),i=p(),n=async()=>F(s,e),d=f.useMemo(()=>({400:async m=>{const{feedback:u}=await m.json();u.forEach(({subject:l,message:c})=>s.setError(l,{message:c}))},429:()=>t.tooMany15(),500:()=>t.serverError(),200:()=>{s.reset(),o({status:"success",title:"Password Successfully Reset",description:"You will be redirected to login shortly."}),setTimeout(i,3e3,"/auth/login")},401:()=>o({status:"error",title:"Failed to Reset Password",description:"The link is either invalid or expired."})}),[]);return x(n,d)}function j({token:s}){const e=y(),o=N(e,s);return r.jsxs("form",{onSubmit:e.handleSubmit(o),"aria-label":"New Password Form",children:[r.jsx(a,{formRef:e,registerKey:"password",placeholder:"Enter password",inputTestId:"NewPwdForm-password",label:"Password",helperText:S.newPwd,type:"password",...e.register("password",h)}),r.jsx(a,{formRef:e,registerKey:"confirmPassword",inputTestId:"NewPwdForm-confirmPassword",errorTestId:"NewPwdForm-confirmPassword-error",placeholder:"Re-enter password",label:"Confirm password",type:"password",...e.register("confirmPassword",{required:"Please confirm your new password",validate:t=>t===e.getValues("password")||"Passwords do not match"})}),r.jsx(P,{type:"submit","data-cy":"NewPwdForm-submit",w:"full",isLoading:e.formState.isSubmitting,children:"Submit"})]})}function V(){const[s]=b();return r.jsx(g,{isOpen:!0,motionPreset:"none",heading:"Your New Password",children:r.jsx(j,{token:s.get("token")})})}export{V as default};
