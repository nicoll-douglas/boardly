import{t as w,q as p,r as f,j as r,G as a,J as h,B as P,E as b}from"./index-BGfUVu-S.js";import{F as g}from"./FormModal-1-jAWOym.js";import{u as y}from"./index.esm-QuqdPL-o.js";import{u as x}from"./useSubmitHandlers-Pj0oRakZ.js";import{h as S}from"./helperText-BjkVZXYi.js";import"./chunk-4FCEGNGT-CWNR6xLH.js";import"./chunk-7254PCTD-C1bqhFCI.js";import"./chunk-OFOVX77R-UToEHXKx.js";import"./chunk-W7WUSNWJ-DKxHapzC.js";async function F(s,e){return fetch("https://lorem-backend-6ggh.onrender.com/api/auth/reset",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s.getValues())})}function N(s,e){const{toast:t,...o}=w(),i=p(),n=async()=>F(s,e),d=f.useMemo(()=>({400:async m=>{const{feedback:u}=await m.json();u.forEach(({subject:c,message:l})=>s.setError(c,{message:l}))},429:()=>o.tooMany15(),500:()=>o.serverError(),200:()=>{s.reset(),t({status:"success",title:"Password Successfully Reset",description:"You will be redirected to login shortly."}),setTimeout(i,3e3,"/auth/login")},401:()=>t({status:"error",title:"Failed to Reset Password",description:"The link is either invalid or expired."})}),[]);return x(n,d)}function j({token:s}){const e=y(),t=N(e,s);return r.jsxs("form",{onSubmit:e.handleSubmit(t),"aria-label":"New Password Form",children:[r.jsx(a,{formRef:e,registerKey:"password",placeholder:"Enter password",inputTestId:"NewPwdForm-password",label:"Password",helperText:S.newPwd,type:"password",...e.register("password",h)}),r.jsx(a,{formRef:e,registerKey:"confirmPassword",inputTestId:"NewPwdForm-confirmPassword",errorTestId:"NewPwdForm-confirmPassword-error",placeholder:"Re-enter password",label:"Confirm password",type:"password",...e.register("confirmPassword",{required:"Please confirm your new password",validate:o=>o===e.getValues("password")||"Passwords do not match"})}),r.jsx(P,{type:"submit","data-cy":"NewPwdForm-submit",w:"full",isLoading:e.formState.isSubmitting,children:"Submit"})]})}function V(){const[s]=b();return r.jsx(g,{isOpen:!0,motionPreset:"none",heading:"Your New Password",children:r.jsx(j,{token:s.get("token")})})}export{V as default};
