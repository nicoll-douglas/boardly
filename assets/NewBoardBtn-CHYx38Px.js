import{a1 as b,c as j,u as y,O as S,r as v,j as e,a2 as m,a3 as c,a4 as C,a5 as L,a6 as N,a7 as w,a8 as F,B as d}from"./index-4ulQWezs.js";import{L as E,A as B}from"./DeletedLabel-DRCkYGds.js";import{F as T}from"./FormModal-CSWPt1cU.js";import{h as q}from"./helperText-BjkVZXYi.js";import{u as R}from"./useSubmitHandlers-DjEugLkN.js";import{u as I}from"./index.esm-p7AaXQnn.js";import{u as M}from"./useMaxLength-b8Ul-RAC.js";import{T as O}from"./useProtectedSubmission-ByvYB6ll.js";import{u as k}from"./chunk-7JBTTEVG-bqMuTkud.js";function X(s){const{wasSelected:r,enabled:t,isSelected:a,mode:n="unmount"}=s;return!!(!t||a||n==="keepMounted"&&r)}const l={name:{required:"Name is required",pattern:{value:b.restricted,message:"Name contains an invalid character"},maxLength:{value:20,message:"Name must be no more than 20 characters long"}},rules:{required:!1,maxLength:{value:100,message:"Rules must be no more than 100 characters long"}}};async function z(s){return fetch("https://lorem-backend-6ggh.onrender.com/api/boards",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}function Q(s){const r=I({shouldUnregister:!0}),{toast:t,...a}=j(),n=async()=>z(r.getValues()),o=y(),i=S(),u=v.useMemo(()=>({401:()=>{a.unauthorized(),o("/auth/login")},409:async g=>{const{feedback:f}=await g.json();f.forEach(({subject:p,message:x})=>r.setError(p,{message:x}))},429:()=>a.tooMany(),500:()=>a.serverError(),200:()=>{i.invalidateQueries({queryKey:["GET /api/me/boards"]}),i.invalidateQueries({queryKey:["GET /api/boards"]}),t({status:"success",title:"Successfully created board"}),s&&s()}}),[]),h=R(n,u);return{form:r,onSubmit:h}}function U({form:s,initialLength:r}){var i;const{onChange:t,...a}=s.register("rules",l.rules),{length:n,onChange:o}=M(r);return e.jsxs(m,{isInvalid:s.formState.errors.rules,mb:6,children:[e.jsx(E,{length:n,maxLength:l.rules.maxLength.value,children:"Rules"}),e.jsx(O,{resize:"none",placeholder:"Enter rules...",rows:8,whiteSpace:"pre-wrap",onChange:u=>{t(u),o(u)},...a}),e.jsx(c,{children:(i=s.formState.errors.rules)==null?void 0:i.message})]})}function A({onClose:s}){var a;const{form:r,onSubmit:t}=Q(s);return e.jsxs("form",{onSubmit:r.handleSubmit(t),"aria-label":"New Board Form",children:[e.jsxs(m,{isRequired:!0,isInvalid:r.formState.errors.name,mb:6,children:[e.jsx(C,{children:"Name"}),e.jsx(L,{placeholder:"Enter name...",...r.register("name",l.name)}),e.jsx(c,{children:(a=r.formState.errors.name)==null?void 0:a.message}),e.jsx(N,{children:e.jsx(w,{children:["Cannot be changed once created",...q.newUn].map((n,o)=>e.jsx(F,{children:n},o))})})]}),e.jsx(U,{form:r,initialLength:0}),e.jsx(d,{w:"full",type:"submit",isLoading:r.formState.isSubmitting,children:"Create"})]})}function Y({...s}){const{isOpen:r,onClose:t,onOpen:a}=k();return e.jsxs(e.Fragment,{children:[e.jsx(d,{variant:"ghost",size:"sm",leftIcon:e.jsx(B,{}),onClick:a,...s,children:"New Board"}),e.jsx(T,{isOpen:r,onClose:t,heading:"New Board",children:e.jsx(A,{onClose:t})})]})}export{Y as N,U as R,X as l};
