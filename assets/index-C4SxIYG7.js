import{r as d,K as Le,m as le,o as H,q as U,M as ze,A as D,t as Ne,v as Re,j as e,y as P,z as E,a as ie,F as v,b as q,N as Ae,O as Q,Q as W,R as G,B as w,U as C,T as S,W as Fe,V as Y,X as Oe,Y as $e,h as Ke,Z as Ue,_ as Ve,$ as He,a0 as qe}from"./index-Dxo2bz0P.js";import{C as Qe,c as We,u as I,T as Ge}from"./ThreadPreview-D4XRRcJL.js";import{l as Ye,R as Xe,N as Je}from"./NewBoardBtn-BKkVnQWa.js";import{N as Ze,D as $,C as B,T as es,t as ss}from"./DeletedLabel-CRdh3O-l.js";import{S as X,n as V}from"./Spinner-C8TFRRvS.js";import{S as J}from"./chunk-7254PCTD-D5hh2A0a.js";import{u as ts}from"./useProfile-B8shdOvM.js";import{D as ce}from"./chunk-7YYN6TNS-BLSKvSgG.js";import{u as Z,L as de,a as ns}from"./useProtectedSubmission-DIboHLpf.js";import{u as ee}from"./useSubmitHandlers-C8_vVDZp.js";import{u as se}from"./chunk-7JBTTEVG-B0CYi711.js";import{A as ue,a as xe,M as fe,H as he}from"./chunk-RAWN7VJ3-f1EUZUKs.js";import{M as me,c as pe,d as be}from"./chunk-4FCEGNGT-DM2xFBbN.js";import{M as je}from"./chunk-OFOVX77R-BGYVS1o_.js";import{D as _}from"./chunk-W7WUSNWJ-Dl6AEbBo.js";import{C as as}from"./chunk-RKXMPHPI-C_hEr9jU.js";import{C as te,a as ye,b as ne}from"./chunk-YQO7BFFX-BuA8T1yt.js";import{c as rs}from"./chatting-2-DAUiPAEq.js";import{F as os}from"./FormModal-BhfQyK4S.js";import{u as ls}from"./index.esm-DLJeC7qE.js";import{b as is}from"./board-Pi6hTLGh.js";import{c as cs}from"./chunk-OCNORRQU-CTjtK_5X.js";import{u as ds}from"./index-C2ozp0Fj.js";import"./index-D_07C-AX.js";import"./helperText-BjkVZXYi.js";import"./useMaxLength-SUOHSmxN.js";import"./useBoardsList-B-Rakyx6.js";function us(){const s=d.useRef(new Map),n=s.current,t=d.useCallback((a,l,i,c)=>{s.current.set(i,{type:l,el:a,options:c}),a.addEventListener(l,i,c)},[]),r=d.useCallback((a,l,i,c)=>{a.removeEventListener(l,i,c),s.current.delete(i)},[]);return d.useEffect(()=>()=>{n.forEach((a,l)=>{r(a.el,a.type,l,a.options)})},[r,n]),{add:t,remove:r}}function K(s){const n=s.target,{tagName:t,isContentEditable:r}=n;return t!=="INPUT"&&t!=="TEXTAREA"&&r!==!0}function xs(s={}){const{ref:n,isDisabled:t,isFocusable:r,clickOnEnter:a=!0,clickOnSpace:l=!0,onMouseDown:i,onMouseUp:c,onClick:u,onKeyDown:x,onKeyUp:p,tabIndex:b,onMouseOver:j,onMouseLeave:y,...g}=s,[m,k]=d.useState(!0),[T,f]=d.useState(!1),h=us(),Se=o=>{o&&o.tagName!=="BUTTON"&&k(!1)},we=m?b:b||0,A=t&&!r,re=d.useCallback(o=>{if(t){o.stopPropagation(),o.preventDefault();return}o.currentTarget.focus(),u==null||u(o)},[t,u]),F=d.useCallback(o=>{T&&K(o)&&(o.preventDefault(),o.stopPropagation(),f(!1),h.remove(document,"keyup",F,!1))},[T,h]),De=d.useCallback(o=>{if(x==null||x(o),t||o.defaultPrevented||o.metaKey||!K(o.nativeEvent)||m)return;const M=a&&o.key==="Enter";l&&o.key===" "&&(o.preventDefault(),f(!0)),M&&(o.preventDefault(),o.currentTarget.click()),h.add(document,"keyup",F,!1)},[t,m,x,a,l,h,F]),Pe=d.useCallback(o=>{if(p==null||p(o),t||o.defaultPrevented||o.metaKey||!K(o.nativeEvent)||m)return;l&&o.key===" "&&(o.preventDefault(),f(!1),o.currentTarget.click())},[l,m,t,p]),O=d.useCallback(o=>{o.button===0&&(f(!1),h.remove(document,"mouseup",O,!1))},[h]),Ee=d.useCallback(o=>{if(o.button!==0)return;if(t){o.stopPropagation(),o.preventDefault();return}m||f(!0),o.currentTarget.focus({preventScroll:!0}),h.add(document,"mouseup",O,!1),i==null||i(o)},[t,m,i,h,O]),Ie=d.useCallback(o=>{o.button===0&&(m||f(!1),c==null||c(o))},[c,m]),Me=d.useCallback(o=>{if(t){o.preventDefault();return}j==null||j(o)},[t,j]),Be=d.useCallback(o=>{T&&(o.preventDefault(),f(!1)),y==null||y(o)},[T,y]),oe=le(n,Se);return m?{...g,ref:oe,type:"button","aria-disabled":A?void 0:t,disabled:A,onClick:re,onMouseDown:i,onMouseUp:c,onKeyUp:p,onKeyDown:x,onMouseOver:j,onMouseLeave:y}:{...g,ref:oe,role:"button","data-active":Le(T),"aria-disabled":t?"true":void 0,tabIndex:A?void 0:we,onClick:re,onMouseDown:Ee,onMouseUp:Ie,onKeyUp:Pe,onKeyDown:De,onMouseOver:Me,onMouseLeave:Be}}var[fs,hs,ms,ps]=cs();function bs(s){var n;const{defaultIndex:t,onChange:r,index:a,isManual:l,isLazy:i,lazyBehavior:c="unmount",orientation:u="horizontal",direction:x="ltr",...p}=s,[b,j]=d.useState(t??0),[y,g]=ds({defaultValue:t??0,value:a,onChange:r});d.useEffect(()=>{a!=null&&j(a)},[a]);const m=ms(),k=d.useId();return{id:`tabs-${(n=s.id)!=null?n:k}`,selectedIndex:y,focusedIndex:b,setSelectedIndex:g,setFocusedIndex:j,isManual:l,isLazy:i,lazyBehavior:c,orientation:u,descendants:m,direction:x,htmlProps:p}}var[js,N]=H({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function ys(s){const{focusedIndex:n,orientation:t,direction:r}=N(),a=hs(),l=d.useCallback(i=>{const c=()=>{var f;const h=a.nextEnabled(n);h&&((f=h.node)==null||f.focus())},u=()=>{var f;const h=a.prevEnabled(n);h&&((f=h.node)==null||f.focus())},x=()=>{var f;const h=a.firstEnabled();h&&((f=h.node)==null||f.focus())},p=()=>{var f;const h=a.lastEnabled();h&&((f=h.node)==null||f.focus())},b=t==="horizontal",j=t==="vertical",y=i.key,g=r==="ltr"?"ArrowLeft":"ArrowRight",m=r==="ltr"?"ArrowRight":"ArrowLeft",T={[g]:()=>b&&u(),[m]:()=>b&&c(),ArrowDown:()=>j&&c(),ArrowUp:()=>j&&u(),Home:x,End:p}[y];T&&(i.preventDefault(),T(i))},[a,n,t,r]);return{...s,role:"tablist","aria-orientation":t,onKeyDown:U(s.onKeyDown,l)}}function Ts(s){const{isDisabled:n=!1,isFocusable:t=!1,...r}=s,{setSelectedIndex:a,isManual:l,id:i,setFocusedIndex:c,selectedIndex:u}=N(),{index:x,register:p}=ps({disabled:n&&!t}),b=x===u,j=()=>{a(x)},y=()=>{c(x),!l&&!(n&&t)&&a(x)};return{...xs({...r,ref:le(p,s.ref),isDisabled:n,isFocusable:t,onClick:U(s.onClick,j)}),id:Te(i,x),role:"tab",tabIndex:b?0:-1,type:"button","aria-selected":b,"aria-controls":ge(i,x),onFocus:n?void 0:U(s.onFocus,y)}}var[gs,vs]=H({});function Cs(s){const n=N(),{id:t,selectedIndex:r}=n,l=ze(s.children).map((i,c)=>d.createElement(gs,{key:c,value:{isSelected:c===r,id:ge(t,c),tabId:Te(t,c),selectedIndex:r}},i));return{...s,children:l}}function ks(s){const{children:n,...t}=s,{isLazy:r,lazyBehavior:a}=N(),{isSelected:l,id:i,tabId:c}=vs(),u=d.useRef(!1);l&&(u.current=!0);const x=Ye({wasSelected:u.current,isSelected:l,enabled:r,mode:a});return{tabIndex:0,...t,children:x?n:null,role:"tabpanel","aria-labelledby":c,hidden:!l,id:i}}function Te(s,n){return`${s}--tab-${n}`}function ge(s,n){return`${s}--tabpanel-${n}`}var[Ss,R]=H({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),ve=D(function(n,t){const r=Ne("Tabs",n),{children:a,className:l,...i}=Re(n),{htmlProps:c,descendants:u,...x}=bs(i),p=d.useMemo(()=>x,[x]),{isFitted:b,...j}=c,y={position:"relative",...r.root};return e.jsx(fs,{value:u,children:e.jsx(js,{value:p,children:e.jsx(Ss,{value:r,children:e.jsx(P.div,{className:E("chakra-tabs",l),ref:t,...j,__css:y,children:a})})})})});ve.displayName="Tabs";var Ce=D(function(n,t){const r=ys({...n,ref:t}),l={display:"flex",...R().tablist};return e.jsx(P.div,{...r,className:E("chakra-tabs__tablist",n.className),__css:l})});Ce.displayName="TabList";var L=D(function(n,t){const r=ks({...n,ref:t}),a=R();return e.jsx(P.div,{outline:"0",...r,className:E("chakra-tabs__tab-panel",n.className),__css:a.tabpanel})});L.displayName="TabPanel";var ke=D(function(n,t){const r=Cs(n),a=R();return e.jsx(P.div,{...r,width:"100%",ref:t,className:E("chakra-tabs__tab-panels",n.className),__css:a.tabpanels})});ke.displayName="TabPanels";var z=D(function(n,t){const r=R(),a=Ts({...n,ref:t}),l={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...r.tab};return e.jsx(P.button,{...a,className:E("chakra-tabs__tab",n.className),__css:l})});z.displayName="Tab";function ws({heading:s="Nothing to show",children:n,imageUrl:t,...r}){return e.jsxs(ie,{flexDir:{base:"column",lg:"row"},gap:{base:0,lg:8},mt:{base:8,lg:0},textAlign:{base:"center",lg:"left"},...r,children:[e.jsxs(v,{flexDir:"column",gap:2,children:[e.jsx(q,{size:"xl",children:s}),n]}),e.jsx("img",{src:t,width:250,height:250})]})}var Ds=Ae({displayName:"EditIcon",path:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})});async function Ps(s){return fetch(`https://lorem-backend-6ggh.onrender.com/api/boards/${s}`,{method:"DELETE",credentials:"include"})}function Es({board:s}){const n=Q(),t=d.useRef(),r=W(),{isOpen:a,onOpen:l,onClose:i}=se(),c=Z(()=>{n.invalidateQueries({queryKey:["GET /api/me/boards"]}),n.invalidateQueries({queryKey:["GET /api/boards"]}),i(),r({status:"success",title:"Successfully deleted board"})}),u=ee(async()=>Ps(s._id),c);return e.jsxs(e.Fragment,{children:[e.jsx(G,{icon:e.jsx(ce,{}),colorScheme:"red",variant:"ghost",size:"xs",onClick:l,zIndex:80,"aria-label":"Delete board"}),e.jsxs(ue,{isOpen:a,onClose:i,size:"sm",children:[e.jsx(me,{}),e.jsxs(xe,{mx:4,children:[e.jsx(pe,{children:`Delete /${s.name}?`}),e.jsx(be,{}),e.jsx(je,{children:"Are you sure you want to delete this board? This action cannot be undone."}),e.jsx(fe,{children:e.jsxs(he,{gap:3,children:[e.jsx(w,{ref:t,onClick:i,children:"Cancel"}),e.jsx(w,{colorScheme:"red",onClick:u,children:"Delete"})]})})]})]})]})}async function Is(s,n){return fetch(`https://lorem-backend-6ggh.onrender.com/api/boards/${s}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}function Ms({board:s,...n}){var b;const t=d.useMemo(()=>({rules:s.rules||""}),[s]),{isOpen:r,onClose:a,onOpen:l}=se(),i=Q(),c=W(),u=ls({shouldUnregister:!0,defaultValues:t}),x=Z(()=>{i.invalidateQueries({queryKey:["GET /api/me/boards"]}),i.invalidateQueries({queryKey:[`GET /api/boards/${s.name}`]}),c({status:"success",title:"Successfully updated board"}),a()}),p=ee(async()=>Is(s._id,u.getValues()),x);return d.useEffect(()=>{u.reset(t)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(G,{variant:"ghost",size:"xs",icon:e.jsx(Ds,{}),onClick:l,"aria-label":"Edit board",...n}),e.jsx(os,{heading:`Edit /${s.name}`,isOpen:r,onClose:a,children:e.jsxs("form",{onSubmit:u.handleSubmit(p),"aria-label":"Edit Board Form",children:[e.jsx(Xe,{initialLength:((b=s.rules)==null?void 0:b.length)??0,form:u}),e.jsx(w,{w:"full",type:"submit",isLoading:u.formState.isSubmitting,children:"Save"})]})})]})}function Bs(){const[s]=C();return e.jsxs(v,{gap:2,alignItems:"center",flexWrap:"wrap",justifyContent:"space-between",children:[e.jsx(q,{size:"md",children:"Activity"}),e.jsxs(v,{gap:2,alignItems:"center",children:[s&&e.jsxs(e.Fragment,{children:[e.jsx(Ze,{}),e.jsx(Je,{})]}),e.jsx(Qe,{})]})]})}function ae({imageUrl:s=We,text:n}){return e.jsx(ie,{w:"full",children:e.jsx(ws,{imageUrl:s,children:e.jsx(S,{children:n})})})}function _s(){const{data:s,isLoading:n}=d.useContext(Fe),[t]=C(),{compactView:r}=I();return n?e.jsx(X,{flex:1}):e.jsx(J,{in:!!s,offsetY:10,children:e.jsx(Y,{gap:r?2:3,flex:1,as:"ul",listStyleType:"none",children:s.threads.length===0?e.jsx(ae,{text:t?"Create a thread to get started!":"This user doesn't have any threads."}):s.threads.map(a=>e.jsx(Ge,{thread:a},a._id))})})}async function Ls(s){return fetch(`https://lorem-backend-6ggh.onrender.com/api/replies/${s}`,{method:"DELETE",credentials:"include"})}function zs({replyId:s,threadId:n}){const t=Q(),r=d.useRef(),a=W(),{isOpen:l,onOpen:i,onClose:c}=se(),u=Z(()=>{t.invalidateQueries({queryKey:["GET /api/me/replies"]}),t.invalidateQueries({queryKey:[`GET /api/threads/${n}`]}),c(),a({status:"success",title:"Successfully deleted reply"})}),x=ee(async()=>Ls(s),u);return e.jsxs(e.Fragment,{children:[e.jsx(G,{icon:e.jsx(ce,{}),colorScheme:"red",variant:"ghost",size:"xs",onClick:i,zIndex:80,"aria-label":"Delete reply"}),e.jsxs(ue,{isOpen:l,onClose:c,size:"sm",children:[e.jsx(me,{}),e.jsxs(xe,{mx:4,children:[e.jsx(pe,{children:"Delete Reply?"}),e.jsx(be,{}),e.jsx(je,{children:"Are you sure you want to delete this reply? This action cannot be undone."}),e.jsx(fe,{children:e.jsxs(he,{gap:3,children:[e.jsx(w,{ref:r,onClick:c,children:"Cancel"}),e.jsx(w,{colorScheme:"red",onClick:x,children:"Delete"})]})})]})]})]})}function Ns({reply:s}){var c;const n=s.parent||s.thread,{compactView:t}=I(),{data:r}=ts(),[a]=C(),l=s.thread.deleted,i=s.thread.board.deleted;return e.jsx(de,{w:"full",children:e.jsxs(te,{size:"sm",variant:"filled",children:[e.jsx(ye,{children:e.jsxs(v,{w:"full",alignItems:"start",gap:4,children:[e.jsxs(Oe,{w:"calc(100% - 210px)",flex:1,children:[e.jsx(as,{in:!t,animateOpacity:!0,children:i?e.jsx($,{preText:"On",children:"deleted board"}):e.jsx(B,{preText:"On",linkText:`/${s.thread.board.name}`,link:`/boards/${s.thread.board.name}`,fontSize:"md",pb:"1px"})}),l?e.jsx($,{preText:"In",children:"deleted thread"}):e.jsx(B,{preText:"In",linkText:s.thread.title,link:`/threads/${s.thread._id}`,fontSize:"md",pb:"1px",overlay:!0})]}),e.jsxs(v,{gap:2,alignItems:"start",minW:"fit-content",children:[e.jsx(es,{children:ss(s.createdAt)}),a&&e.jsx(zs,{replyId:s._id,threadId:s.thread._id})]})]})}),e.jsx(_,{}),e.jsxs(ne,{children:[((c=s.parent)==null?void 0:c.deleted)&&e.jsxs(e.Fragment,{children:[e.jsx(S,{fontStyle:"italic",color:"gray.500",children:"Reply was deleted"}),e.jsx(_,{my:t?2:3})]}),!n.deleted&&e.jsxs(e.Fragment,{children:[n.author.deleted?e.jsx($,{postText:"said:",children:"deleted user"}):e.jsx(B,{postText:"said:",linkText:`${n.author.username}`,link:`/users/${n.author.username}`,fontSize:"md"}),e.jsx(S,{...t?V:{},whiteSpace:t?"nowrap":"pre-wrap",lineHeight:1.25,children:n.body||n.title}),e.jsx(_,{my:t?2:3})]}),a?e.jsx(S,{size:"sm",h:"21px",children:"You replied:"}):e.jsx(B,{postText:"replied:",linkText:r.profile.username,link:`/users/${r.profile.username}`,fontSize:"md"}),e.jsx(S,{...t?V:{},whiteSpace:t?"nowrap":"pre-wrap",lineHeight:1.25,children:s.body})]})]})})}function Rs(){const{data:s,isLoading:n}=d.useContext($e),[t]=C(),{compactView:r}=I();return n?e.jsx(X,{p:4}):e.jsx(J,{in:!!s,offsetY:10,children:e.jsx(Y,{gap:r?2:3,flex:1,as:"ul",listStyleType:"none",children:s.replies.length===0?e.jsx(ae,{text:t?"Your replies to other users will show up here!":"This user doesnt't have any replies.",imageUrl:rs}):s.replies.map(a=>e.jsx(Ns,{reply:a},a._id))})})}function As({board:s}){const{compactView:n}=I(),[t]=C();return e.jsx(de,{w:"full",children:e.jsx(te,{size:"sm",w:"full",variant:"filled",children:e.jsx(ne,{py:n?2:3,children:e.jsxs(v,{justifyContent:"space-between",alignItems:"center",gap:4,children:[e.jsx(ns,{as:Ke,to:`/boards/${s.name}`,maxW:{base:"calc(100% - 40px)",sm:"calc(100% - 165px)"},children:e.jsx(q,{size:{base:"sm",md:"md"},...V,children:`/${s.name}`})}),t&&e.jsxs(v,{gap:2,minW:"fit-content",children:[e.jsx(Ms,{board:s}),e.jsx(Es,{board:s})]})]})})})})}function Fs(){const{data:s,isLoading:n}=d.useContext(Ue),[t]=C(),{compactView:r}=I();return n?e.jsx(X,{p:4}):e.jsx(J,{in:!!s,offsetY:10,children:e.jsx(Y,{gap:r?1:2,flex:1,as:"ul",listStyleType:"none",children:s.boards.length===0?e.jsx(ae,{text:t?"Any boards you administrate will show up here!":"This user doesn't administrate any boards.",imageUrl:is}):s.boards.map(a=>e.jsx(As,{board:a},a._id))})})}function Os(){return e.jsxs(te,{variant:{base:"unstyled",md:"outline"},flex:1,size:"sm",minH:{md:"calc(100vh - 88px)"},maxW:"full",as:"section","aria-label":"Activity",children:[e.jsx(ye,{children:e.jsx(Bs,{})}),e.jsx(_,{my:{base:4,md:0}}),e.jsx(ne,{children:e.jsxs(ve,{isLazy:!0,display:"flex",flexDir:"column",h:"full",children:[e.jsxs(Ce,{children:[e.jsx(z,{children:"Threads"}),e.jsx(z,{children:"Replies"}),e.jsx(z,{children:"Boards"})]}),e.jsxs(ke,{flex:1,display:"flex",flexDir:"column",children:[e.jsx(L,{px:{base:0,lg:4},flex:1,display:"flex",flexDir:"column",children:e.jsx(Ve,{children:e.jsx(_s,{})})}),e.jsx(L,{px:{base:0,lg:4},flex:1,display:"flex",flexDir:"column",children:e.jsx(He,{children:e.jsx(Rs,{})})}),e.jsx(L,{px:{base:0,lg:4},flex:1,display:"flex",flexDir:"column",children:e.jsx(qe,{children:e.jsx(Fs,{})})})]})]})})]})}function mt(){return e.jsx(Os,{})}export{mt as default};
